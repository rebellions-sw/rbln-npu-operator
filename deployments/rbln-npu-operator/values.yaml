# Default values for rbln-npu-operator.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

# The base name used for rbln components.
name: rbln

# Node Feature Discovery dependency
nfd:
  enabled: false

# Common defaults that apply to all managed component DaemonSets.
daemonsets:
  labels: {}
  annotations: {}
  affinity: {}
  tolerations: []
  # Example: allow scheduling on control plane nodes
  # tolerations:
  # - key: node-role.kubernetes.io/control-plane
  #   operator: Exists
  #   effect: NoSchedule
  priorityClassName: ""

# Operator configuration
operator:
  # Operator image configuration
  image:
    registry: docker.io
    repository: rebellions/rbln-npu-operator
    tag: latest
    pullPolicy: IfNotPresent
  # Resource configuration
  replicas: 1
  resources:
    limits:
      cpu: 500m
      memory: 256Mi
    requests:
      cpu: 50m
      memory: 128Mi
  # Service configuration
  service:
    type: ClusterIP
    port: 8443
    targetPort: 8443
  # Pod security context
  securityContext:
    runAsNonRoot: true

  # Affinity configuration
  # Override these values to control where the operator runs
  # Default: no affinity (can run on any node)
  #
  # Example for control plane nodes:
  # affinity:
  #   nodeAffinity:
  #     preferredDuringSchedulingIgnoredDuringExecution:
  #     - weight: 1
  #       preference:
  #         matchExpressions:
  #         - key: "node-role.kubernetes.io/control-plane"
  #           operator: Exists
  affinity: {}

  # Tolerations configuration
  # Override these values to allow running on tainted nodes
  # Default: no tolerations (only run on untainted nodes)
  #
  # Example for control plane nodes:
  # tolerations:
  # - key: "node-role.kubernetes.io/control-plane"
  #   operator: Exists
  #   effect: NoSchedule
  # - key: "node-role.kubernetes.io/master"
  #   operator: Exists
  #   effect: NoSchedule
  tolerations: []

# Driver configuration
driver:
  enabled: true
  image:
    registry: repo.rebellions.ai
    repository: rebellions/rbln-driver
    tag: 3.0.0
    pullPolicy: IfNotPresent
  # Example:
  # imagePullSecrets:
  # - my-registry-secret
  # imagePullSecrets: []
  # Example:
  # nodeSelector:
  #   rebellions.ai/old: "true"
  nodeSelector: {}
  # Example:
  # nodeAffinity:
  #   requiredDuringSchedulingIgnoredDuringExecution:
  #     nodeSelectorTerms:
  #     - matchExpressions:
  #       - key: kubernetes.io/arch
  #         operator: In
  #         values:
  #         - amd64
  nodeAffinity: {}
  # Example:
  # tolerations:
  # - key: node-role.kubernetes.io/control-plane
  #   operator: Exists
  #   effect: NoSchedule
  tolerations: []
  # Example:
  # labels:
  #   app.kubernetes.io/component: driver
  labels: {}
  # Example:
  # annotations:
  #   my-annotation: "true"
  annotations: {}
  # Example:
  # priorityClassName: system-node-critical
  priorityClassName: ""
  # Example:
  # resources:
  #   requests:
  #     cpu: 250m
  #     memory: 64Mi
  #   limits:
  #     cpu: 500m
  #     memory: 128Mi
  resources: {}
  # Example:
  # args:
  # - init
  args: []
  # Example:
  # env:
  # - name: RBLN_DRIVER_LOG_LEVEL
  #   value: info
  env: []
  # Example:
  manager:
    registry: docker.io
    image: rebellions/rbln-k8s-driver-manager
    version: v0.1.1
    imagePullPolicy: IfNotPresent
  #  imagePullSecrets:
  #  - my-registry-secret
  #  env:
  #  - name: RBLN_MANAGER_LOG_LEVEL
  #    value: info


# NPU Device Plugin configuration
devicePlugin:
  enabled: true
  image:
    registry: docker.io
    repository: rebellions/k8s-device-plugin
    tag: v0.3.7
    pullPolicy: IfNotPresent
  hostBinPath: /usr/bin

  resourceList:
  - productCardNames:
    - RBLN-CA12
    - RBLN-CA22
    - RBLN-CA25
    resourceName: ATOM
    resourcePrefix: rebellions.ai
  - productCardNames:
    - RBLN-CR03
    resourceName: REBEL
    resourcePrefix: rebellions.ai

# NPU Metrics Exporter configuration
metricsExporter:
  enabled: true
  image:
    registry: docker.io
    repository: rebellions/rbln-metrics-exporter
    tag: v0.2.3
    pullPolicy: IfNotPresent

# RBLN Daemon configuration
rblnDaemon:
  enabled: true
  image:
    registry: repo.rebellions.ai
    repository: rebellions/rbln-daemon
    tag: 3.0.0
    pullPolicy: IfNotPresent
  # imagePullSecrets:
  # - daemoncred
  hostPort: 50051
  resources: {}
  args: []
  env: []

# NPU Feature Discovery configuration
npuFeatureDiscovery:
  enabled: true
  image:
    registry: docker.io
    repository: rebellions/rbln-npu-feature-discovery
    tag: v0.2.0
    pullPolicy: IfNotPresent

# Container Toolkit configuration
containerToolkit:
  enabled: true
  image:
    registry: docker.io
    repository: rebellions/rbln-container-toolkit
    tag: v0.1.0
    pullPolicy: IfNotPresent
  imagePullSecrets: []
  resources: {}
  args: []
  env: []

# Sandbox Device Plugin for VM workloads
sandboxDevicePlugin:
  enabled: false
  image:
    registry: docker.io
    repository: rebellions/k8s-device-plugin
    tag: v0.3.7
    pullPolicy: IfNotPresent

  # VFIO Checker configuration
  vfioChecker:
    image:
      registry: docker.io
      repository: rebellions/rbln-vfio-manager
      tag: latest
  # Resource discovery for sandbox workloads
  resourceList:
  - productCardNames:
    - RBLN-CA12
    resourceName: ATOM_PT
    resourcePrefix: rebellions.ai
  - productCardNames:
    - RBLN-CA25
    resourceName: ATOM_MAX_PT
    resourcePrefix: rebellions.ai
  - productCardNames:
    - RBLN-CR03
    resourceName: REBEL_PT
    resourcePrefix: rebellions.ai

# VFIO Manager for VM workloads
vfioManager:
  enabled: false
  image:
    registry: docker.io
    repository: rebellions/rbln-vfio-manager
    tag: latest
    pullPolicy: IfNotPresent

# Validator configuration
validator:
  image:
    registry: docker.io
    repository: rebellions/rbln-npu-operator-validator
    tag: latest
    pullPolicy: IfNotPresent
  imagePullSecrets: []
  resources: {}
  args: []
  env: []
  plugin:
    env: []
  toolkit:
    env: []
  driver:
    env: []
  vfioPCI:
    env: []
